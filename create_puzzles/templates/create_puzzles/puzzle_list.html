<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Puzzle List</title>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- DataTables CSS & JS -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<style>
body { font-family: Arial, sans-serif; margin: 20px; }
h1 { color: #333; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; }
th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
a { text-decoration: none; color: white; padding: 6px 12px; border-radius: 4px; }

/* Button Colors */
.btn-create { background-color: green; margin-bottom: 15px; display: inline-block; }
.btn-edit { background-color: blue; margin-right:5px;  padding 4px 8px;border-radius:4px;
            display:inline-block; }
.btn-delete { background-color: red; margin-top:5px; display:inline-block;}
.btn:hover { opacity: 0.8; }

#searchBar { margin-bottom: 15px; padding: 6px; width: 300px; display: block; }
</style>
</head>

<body>

<h1>Math Puzzles</h1>

<!-- Create Button -->
<p>
    <a class="btn btn-create" href="{% url 'puzzle-create' %}">Create New Puzzle</a>
</p>

<!-- Search Bar -->
<input type="text" id="searchBar" placeholder="Search by ID, Name, Title, Author...">

<!-- Puzzle Table -->
<table id="puzzleTable" class="display">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Title</th>
            <th>Grid</th>
            <th>Solution</th>
            <th>Author</th>
            <th>Created At</th>
            <th>Updated At</th>
            <th>Created By</th>
            <th>Updated By</th>
            <th> Options </th>
        </tr>
    </thead>
    <tbody>
        {% for puzzle in page_obj %}
        <tr>
            <td>{{ puzzle.id }}</td>
            <td>{{ puzzle.name }}</td>
            <td>{{ puzzle.title }}</td>
            <td>{{ puzzle.grid }}</td>
            <td>{{ puzzle.solution }}</td>
            <td>{{ puzzle.author }}</td>
            <td>{{ puzzle.created_at }}</td>
            <td>{{ puzzle.updated_at }}</td>
            <td>{{ puzzle.created_by }}</td>
            <td>{{ puzzle.updated_by }}</td>
            
            <td>
                <a class="btn btn-edit" href="{% url 'puzzle-update' puzzle.id %}">Edit</a>
                <a class="btn btn-delete" href="{% url 'puzzle-delete' puzzle.id %}">Delete</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="11">No puzzles available.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
$(document).ready(function() {
    // Initialize DataTable
    var table = $('#puzzleTable').DataTable({
        "pageLength": 5,
        "lengthChange": false,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "columnDefs": [
            { "orderable": false, "targets": 10 } // Options column not sortable
        ],
        "dom": 'lrtip' // Remove default search box
    });

    // Custom search bar for all columns including numeric ID
    $('#searchBar').on('keyup', function() {
        table.search(this.value).draw();
    });
});
</script>

</body>
</html>